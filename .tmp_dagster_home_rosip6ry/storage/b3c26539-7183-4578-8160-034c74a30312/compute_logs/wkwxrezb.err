[32m2025-09-08 11:27:33 -0500[0m - dagster - [34mDEBUG[0m - youtube_job - b3c26539-7183-4578-8160-034c74a30312 - 35134 - LOGS_CAPTURED - Started capturing logs in process (pid: 35134).
[32m2025-09-08 11:27:33 -0500[0m - dagster - [34mDEBUG[0m - youtube_job - b3c26539-7183-4578-8160-034c74a30312 - 35134 - youtube_search_op - STEP_START - Started execution of step "youtube_search_op".
[32m2025-09-08 11:27:33 -0500[0m - dagster - [34mDEBUG[0m - youtube_job - b3c26539-7183-4578-8160-034c74a30312 - youtube_search_op - Loading file from: /Users/alisoncordoba/captone/music_and_marketing_audit/.tmp_dagster_home_rosip6ry/storage/b3c26539-7183-4578-8160-034c74a30312/youtube_videos_op/videos_df using PickledObjectFilesystemIOManager...
[32m2025-09-08 11:27:33 -0500[0m - dagster - [34mDEBUG[0m - youtube_job - b3c26539-7183-4578-8160-034c74a30312 - 35134 - youtube_search_op - LOADED_INPUT - Loaded input "videos_df" using input manager "io_manager", from output "videos_df" of step "youtube_videos_op"
[32m2025-09-08 11:27:33 -0500[0m - dagster - [34mDEBUG[0m - youtube_job - b3c26539-7183-4578-8160-034c74a30312 - 35134 - youtube_search_op - STEP_INPUT - Got input "videos_df" of type "Any". (Type check passed).
2025-09-08 11:27:33,723 - INFO - YouTube API client initialized successfully.
2025-09-08 11:27:33,724 - DEBUG - Starting new HTTP connection (1): localhost:9000
2025-09-08 11:27:33,734 - DEBUG - http://localhost:9000 "GET /bronze-layer?location= HTTP/1.1" 200 0
2025-09-08 11:27:33,739 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_pop.parquet HTTP/1.1" 200 2356
2025-09-08 11:27:33,789 - INFO - [CACHE HIT] Loaded 51 videos for 'pop' from MinIO.
2025-09-08 11:27:33,790 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=pop&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:27:34,317 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_pop.parquet HTTP/1.1" 200 0
2025-09-08 11:27:34,322 - INFO - [API CALL] Saved 50 new videos for 'pop' (total 51) to MinIO.
2025-09-08 11:27:34,327 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_electronic.parquet HTTP/1.1" 200 2400
2025-09-08 11:27:34,329 - INFO - [CACHE HIT] Loaded 52 videos for 'electronic' from MinIO.
2025-09-08 11:27:34,329 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=electronic&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:27:35,016 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_electronic.parquet HTTP/1.1" 200 0
2025-09-08 11:27:35,017 - INFO - [API CALL] Saved 50 new videos for 'electronic' (total 52) to MinIO.
2025-09-08 11:27:35,023 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_heavy%20metal.parquet HTTP/1.1" 200 2396
2025-09-08 11:27:35,026 - INFO - [CACHE HIT] Loaded 51 videos for 'heavy metal' from MinIO.
2025-09-08 11:27:35,027 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=heavy+metal&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:27:35,579 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_heavy%20metal.parquet HTTP/1.1" 200 0
2025-09-08 11:27:35,580 - INFO - [API CALL] Saved 50 new videos for 'heavy metal' (total 51) to MinIO.
2025-09-08 11:27:35,586 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_country.parquet HTTP/1.1" 200 2380
2025-09-08 11:27:35,588 - INFO - [CACHE HIT] Loaded 51 videos for 'country' from MinIO.
2025-09-08 11:27:35,589 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=country&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:27:36,065 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_country.parquet HTTP/1.1" 200 0
2025-09-08 11:27:36,065 - INFO - [API CALL] Saved 50 new videos for 'country' (total 51) to MinIO.
2025-09-08 11:27:36,069 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_jazz.parquet HTTP/1.1" 200 2415
2025-09-08 11:27:36,072 - INFO - [CACHE HIT] Loaded 55 videos for 'jazz' from MinIO.
2025-09-08 11:27:36,072 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=jazz&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:27:36,473 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_jazz.parquet HTTP/1.1" 200 0
2025-09-08 11:27:36,474 - INFO - [API CALL] Saved 50 new videos for 'jazz' (total 55) to MinIO.
2025-09-08 11:27:36,478 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_hip%20hop.parquet HTTP/1.1" 200 2412
2025-09-08 11:27:36,482 - INFO - [CACHE HIT] Loaded 54 videos for 'hip hop' from MinIO.
2025-09-08 11:27:36,482 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=hip+hop&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:27:36,923 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_hip%20hop.parquet HTTP/1.1" 200 0
2025-09-08 11:27:36,925 - INFO - [API CALL] Saved 50 new videos for 'hip hop' (total 54) to MinIO.
2025-09-08 11:27:36,930 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_classical.parquet HTTP/1.1" 200 2513
2025-09-08 11:27:36,933 - INFO - [CACHE HIT] Loaded 60 videos for 'classical' from MinIO.
2025-09-08 11:27:36,933 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=classical&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:27:37,327 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_classical.parquet HTTP/1.1" 200 0
2025-09-08 11:27:37,328 - INFO - [API CALL] Saved 50 new videos for 'classical' (total 60) to MinIO.
2025-09-08 11:27:37,331 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_folk.parquet HTTP/1.1" 200 2345
2025-09-08 11:27:37,334 - INFO - [CACHE HIT] Loaded 50 videos for 'folk' from MinIO.
2025-09-08 11:27:37,335 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=folk&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:27:37,721 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_folk.parquet HTTP/1.1" 200 0
2025-09-08 11:27:37,722 - INFO - [API CALL] Saved 50 new videos for 'folk' (total 50) to MinIO.
2025-09-08 11:27:37,729 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_rock.parquet HTTP/1.1" 200 2348
2025-09-08 11:27:37,730 - INFO - [CACHE HIT] Loaded 50 videos for 'rock' from MinIO.
2025-09-08 11:27:37,731 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=rock&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:27:38,120 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_rock.parquet HTTP/1.1" 200 0
2025-09-08 11:27:38,121 - INFO - [API CALL] Saved 50 new videos for 'rock' (total 50) to MinIO.
2025-09-08 11:27:38,124 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_reggae.parquet HTTP/1.1" 200 3011
2025-09-08 11:27:38,131 - INFO - [CACHE HIT] Loaded 96 videos for 'reggae' from MinIO.
2025-09-08 11:27:38,131 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=reggae&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:27:38,568 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_reggae.parquet HTTP/1.1" 200 0
2025-09-08 11:27:38,568 - INFO - [API CALL] Saved 50 new videos for 'reggae' (total 96) to MinIO.
2025-09-08 11:27:38,571 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_blues.parquet HTTP/1.1" 200 3150
2025-09-08 11:27:38,573 - INFO - [CACHE HIT] Loaded 106 videos for 'blues' from MinIO.
2025-09-08 11:27:38,573 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=blues&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:27:38,992 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_blues.parquet HTTP/1.1" 200 0
2025-09-08 11:27:38,993 - INFO - [API CALL] Saved 50 new videos for 'blues' (total 106) to MinIO.
2025-09-08 11:27:39,001 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_r%26b.parquet HTTP/1.1" 200 2345
2025-09-08 11:27:39,003 - INFO - [CACHE HIT] Loaded 50 videos for 'r&b' from MinIO.
2025-09-08 11:27:39,003 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=r%26b&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:27:39,461 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_r%26b.parquet HTTP/1.1" 200 0
2025-09-08 11:27:39,461 - INFO - [API CALL] Saved 50 new videos for 'r&b' (total 50) to MinIO.
2025-09-08 11:27:39,485 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search.parquet HTTP/1.1" 200 0
2025-09-08 11:27:39,485 - INFO - Uploaded youtube_search.parquet to MinIO bucket bronze-layer
2025-09-08 11:27:39,485 - INFO - Merged search table saved: youtube_search.parquet with 710 rows
2025-09-08 11:27:39,485 - INFO - Videos Found by Genre Query (first 5 rows):
2025-09-08 11:27:39,489 - INFO - 
      video_id genre
0  kPa7bsKwL-c   pop
1  6JnGBs88sL0   pop
2  nYnLVWXmRm8   pop
3  C-u5WLJ9Yk4   pop
4  cb12KmMMDJA   pop
[32m2025-09-08 11:27:39 -0500[0m - dagster - [34mDEBUG[0m - youtube_job - b3c26539-7183-4578-8160-034c74a30312 - 35134 - youtube_search_op - STEP_OUTPUT - Yielded output "search_df" of type "Any". (Type check passed).
[32m2025-09-08 11:27:39 -0500[0m - dagster - [34mDEBUG[0m - youtube_job - b3c26539-7183-4578-8160-034c74a30312 - youtube_search_op - Writing file at: /Users/alisoncordoba/captone/music_and_marketing_audit/.tmp_dagster_home_rosip6ry/storage/b3c26539-7183-4578-8160-034c74a30312/youtube_search_op/search_df using PickledObjectFilesystemIOManager...
[32m2025-09-08 11:27:39 -0500[0m - dagster - [34mDEBUG[0m - youtube_job - b3c26539-7183-4578-8160-034c74a30312 - 35134 - youtube_search_op - HANDLED_OUTPUT - Handled output "search_df" using IO manager "io_manager"
[32m2025-09-08 11:27:39 -0500[0m - dagster - [34mDEBUG[0m - youtube_job - b3c26539-7183-4578-8160-034c74a30312 - 35134 - youtube_search_op - STEP_SUCCESS - Finished execution of step "youtube_search_op" in 5.81s.
