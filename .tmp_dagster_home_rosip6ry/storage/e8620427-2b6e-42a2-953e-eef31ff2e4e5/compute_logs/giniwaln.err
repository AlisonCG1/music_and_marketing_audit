[32m2025-09-08 11:21:30 -0500[0m - dagster - [34mDEBUG[0m - youtube_job - e8620427-2b6e-42a2-953e-eef31ff2e4e5 - 32451 - LOGS_CAPTURED - Started capturing logs in process (pid: 32451).
[32m2025-09-08 11:21:30 -0500[0m - dagster - [34mDEBUG[0m - youtube_job - e8620427-2b6e-42a2-953e-eef31ff2e4e5 - 32451 - youtube_search_op - STEP_START - Started execution of step "youtube_search_op".
[32m2025-09-08 11:21:30 -0500[0m - dagster - [34mDEBUG[0m - youtube_job - e8620427-2b6e-42a2-953e-eef31ff2e4e5 - youtube_search_op - Loading file from: /Users/alisoncordoba/captone/music_and_marketing_audit/.tmp_dagster_home_rosip6ry/storage/e8620427-2b6e-42a2-953e-eef31ff2e4e5/youtube_videos_op/videos_df using PickledObjectFilesystemIOManager...
[32m2025-09-08 11:21:30 -0500[0m - dagster - [34mDEBUG[0m - youtube_job - e8620427-2b6e-42a2-953e-eef31ff2e4e5 - 32451 - youtube_search_op - LOADED_INPUT - Loaded input "videos_df" using input manager "io_manager", from output "videos_df" of step "youtube_videos_op"
[32m2025-09-08 11:21:30 -0500[0m - dagster - [34mDEBUG[0m - youtube_job - e8620427-2b6e-42a2-953e-eef31ff2e4e5 - 32451 - youtube_search_op - STEP_INPUT - Got input "videos_df" of type "Any". (Type check passed).
2025-09-08 11:21:30,209 - INFO - YouTube API client initialized successfully.
2025-09-08 11:21:30,209 - DEBUG - Starting new HTTP connection (1): localhost:9000
2025-09-08 11:21:30,212 - DEBUG - http://localhost:9000 "GET /bronze-layer?location= HTTP/1.1" 200 0
2025-09-08 11:21:30,216 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_pop.parquet HTTP/1.1" 200 2344
2025-09-08 11:21:30,295 - INFO - [CACHE HIT] Loaded 50 videos for 'pop' from MinIO.
2025-09-08 11:21:30,296 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=pop&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:21:30,808 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_pop.parquet HTTP/1.1" 200 0
2025-09-08 11:21:30,809 - INFO - [API CALL] Saved 50 new videos for 'pop' (total 50) to MinIO.
2025-09-08 11:21:30,811 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_electronic.parquet HTTP/1.1" 200 2375
2025-09-08 11:21:30,814 - INFO - [CACHE HIT] Loaded 50 videos for 'electronic' from MinIO.
2025-09-08 11:21:30,815 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=electronic&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:21:31,234 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_electronic.parquet HTTP/1.1" 200 0
2025-09-08 11:21:31,234 - INFO - [API CALL] Saved 50 new videos for 'electronic' (total 51) to MinIO.
2025-09-08 11:21:31,237 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_heavy%20metal.parquet HTTP/1.1" 200 2384
2025-09-08 11:21:31,238 - INFO - [CACHE HIT] Loaded 50 videos for 'heavy metal' from MinIO.
2025-09-08 11:21:31,238 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=heavy+metal&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:21:31,695 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_heavy%20metal.parquet HTTP/1.1" 200 0
2025-09-08 11:21:31,695 - INFO - [API CALL] Saved 50 new videos for 'heavy metal' (total 50) to MinIO.
2025-09-08 11:21:31,698 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_country.parquet HTTP/1.1" 200 2367
2025-09-08 11:21:31,700 - INFO - [CACHE HIT] Loaded 50 videos for 'country' from MinIO.
2025-09-08 11:21:31,700 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=country&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:21:32,365 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_country.parquet HTTP/1.1" 200 0
2025-09-08 11:21:32,365 - INFO - [API CALL] Saved 50 new videos for 'country' (total 50) to MinIO.
2025-09-08 11:21:32,368 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_jazz.parquet HTTP/1.1" 200 2350
2025-09-08 11:21:32,370 - INFO - [CACHE HIT] Loaded 50 videos for 'jazz' from MinIO.
2025-09-08 11:21:32,370 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=jazz&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:21:32,830 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_jazz.parquet HTTP/1.1" 200 0
2025-09-08 11:21:32,831 - INFO - [API CALL] Saved 50 new videos for 'jazz' (total 54) to MinIO.
2025-09-08 11:21:32,836 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_hip%20hop.parquet HTTP/1.1" 200 2360
2025-09-08 11:21:32,840 - INFO - [CACHE HIT] Loaded 50 videos for 'hip hop' from MinIO.
2025-09-08 11:21:32,840 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=hip+hop&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:21:33,246 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_hip%20hop.parquet HTTP/1.1" 200 0
2025-09-08 11:21:33,246 - INFO - [API CALL] Saved 50 new videos for 'hip hop' (total 54) to MinIO.
2025-09-08 11:21:33,253 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_classical.parquet HTTP/1.1" 200 2376
2025-09-08 11:21:33,258 - INFO - [CACHE HIT] Loaded 50 videos for 'classical' from MinIO.
2025-09-08 11:21:33,258 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=classical&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:21:33,584 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_classical.parquet HTTP/1.1" 200 0
2025-09-08 11:21:33,584 - INFO - [API CALL] Saved 50 new videos for 'classical' (total 60) to MinIO.
2025-09-08 11:21:33,587 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_folk.parquet HTTP/1.1" 200 2345
2025-09-08 11:21:33,592 - INFO - [CACHE HIT] Loaded 50 videos for 'folk' from MinIO.
2025-09-08 11:21:33,593 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=folk&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:21:33,933 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_folk.parquet HTTP/1.1" 200 0
2025-09-08 11:21:33,933 - INFO - [API CALL] Saved 50 new videos for 'folk' (total 50) to MinIO.
2025-09-08 11:21:33,944 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_rock.parquet HTTP/1.1" 200 2348
2025-09-08 11:21:33,946 - INFO - [CACHE HIT] Loaded 50 videos for 'rock' from MinIO.
2025-09-08 11:21:33,946 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=rock&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:21:34,495 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_rock.parquet HTTP/1.1" 200 0
2025-09-08 11:21:34,495 - INFO - [API CALL] Saved 50 new videos for 'rock' (total 50) to MinIO.
2025-09-08 11:21:34,497 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_reggae.parquet HTTP/1.1" 200 2356
2025-09-08 11:21:34,499 - INFO - [CACHE HIT] Loaded 50 videos for 'reggae' from MinIO.
2025-09-08 11:21:34,499 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=reggae&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:21:34,940 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_reggae.parquet HTTP/1.1" 200 0
2025-09-08 11:21:34,941 - INFO - [API CALL] Saved 50 new videos for 'reggae' (total 50) to MinIO.
2025-09-08 11:21:34,944 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_blues.parquet HTTP/1.1" 200 2347
2025-09-08 11:21:34,946 - INFO - [CACHE HIT] Loaded 50 videos for 'blues' from MinIO.
2025-09-08 11:21:34,946 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=blues&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:21:35,446 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_blues.parquet HTTP/1.1" 200 0
2025-09-08 11:21:35,447 - INFO - [API CALL] Saved 50 new videos for 'blues' (total 61) to MinIO.
2025-09-08 11:21:35,450 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_r%26b.parquet HTTP/1.1" 200 2345
2025-09-08 11:21:35,453 - INFO - [CACHE HIT] Loaded 50 videos for 'r&b' from MinIO.
2025-09-08 11:21:35,454 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=r%26b&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:21:35,883 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_r%26b.parquet HTTP/1.1" 200 0
2025-09-08 11:21:35,883 - INFO - [API CALL] Saved 50 new videos for 'r&b' (total 50) to MinIO.
2025-09-08 11:21:35,884 - ERROR - Error in youtube_search_op: object of type 'Minio' has no len()
[32m2025-09-08 11:21:35 -0500[0m - dagster - [34mERROR[0m - [31myoutube_job - e8620427-2b6e-42a2-953e-eef31ff2e4e5 - 32451 - youtube_search_op - STEP_FAILURE - Execution of step "youtube_search_op" failed.

dagster._core.errors.DagsterExecutionStepExecutionError: Error occurred while executing op "youtube_search_op"::

TypeError: object of type 'Minio' has no len()

Stack Trace:
  File "/Users/alisoncordoba/captone/music_and_marketing_audit/.venv/lib/python3.13/site-packages/dagster/_core/execution/plan/utils.py", line 57, in op_execution_error_boundary
    yield
  File "/Users/alisoncordoba/captone/music_and_marketing_audit/.venv/lib/python3.13/site-packages/dagster/_utils/__init__.py", line 392, in iterate_with_context
    next_output = next(iterator)
  File "/Users/alisoncordoba/captone/music_and_marketing_audit/src/ingestion/youtubeapi.py", line 280, in youtube_search_op
    search_df = merge_search_tables(all_data_list, minio_client)
  File "/Users/alisoncordoba/captone/music_and_marketing_audit/src/ingestion/youtubeapi.py", line 172, in merge_search_tables
    if search_queries and len(search_queries) == len(all_data_list):
                          ~~~^^^^^^^^^^^^^^^^
[0m
