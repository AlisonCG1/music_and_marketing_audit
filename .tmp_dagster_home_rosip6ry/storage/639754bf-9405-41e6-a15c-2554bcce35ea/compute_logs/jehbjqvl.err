[32m2025-09-08 11:23:51 -0500[0m - dagster - [34mDEBUG[0m - youtube_job - 639754bf-9405-41e6-a15c-2554bcce35ea - 33489 - LOGS_CAPTURED - Started capturing logs in process (pid: 33489).
[32m2025-09-08 11:23:51 -0500[0m - dagster - [34mDEBUG[0m - youtube_job - 639754bf-9405-41e6-a15c-2554bcce35ea - 33489 - youtube_search_op - STEP_START - Started execution of step "youtube_search_op".
[32m2025-09-08 11:23:51 -0500[0m - dagster - [34mDEBUG[0m - youtube_job - 639754bf-9405-41e6-a15c-2554bcce35ea - youtube_search_op - Loading file from: /Users/alisoncordoba/captone/music_and_marketing_audit/.tmp_dagster_home_rosip6ry/storage/639754bf-9405-41e6-a15c-2554bcce35ea/youtube_videos_op/videos_df using PickledObjectFilesystemIOManager...
[32m2025-09-08 11:23:51 -0500[0m - dagster - [34mDEBUG[0m - youtube_job - 639754bf-9405-41e6-a15c-2554bcce35ea - 33489 - youtube_search_op - LOADED_INPUT - Loaded input "videos_df" using input manager "io_manager", from output "videos_df" of step "youtube_videos_op"
[32m2025-09-08 11:23:51 -0500[0m - dagster - [34mDEBUG[0m - youtube_job - 639754bf-9405-41e6-a15c-2554bcce35ea - 33489 - youtube_search_op - STEP_INPUT - Got input "videos_df" of type "Any". (Type check passed).
2025-09-08 11:23:51,494 - INFO - YouTube API client initialized successfully.
2025-09-08 11:23:51,495 - DEBUG - Starting new HTTP connection (1): localhost:9000
2025-09-08 11:23:51,499 - DEBUG - http://localhost:9000 "GET /bronze-layer?location= HTTP/1.1" 200 0
2025-09-08 11:23:51,505 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_pop.parquet HTTP/1.1" 200 2356
2025-09-08 11:23:51,554 - INFO - [CACHE HIT] Loaded 51 videos for 'pop' from MinIO.
2025-09-08 11:23:51,555 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=pop&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:23:52,041 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_pop.parquet HTTP/1.1" 200 0
2025-09-08 11:23:52,042 - INFO - [API CALL] Saved 50 new videos for 'pop' (total 51) to MinIO.
2025-09-08 11:23:52,045 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_electronic.parquet HTTP/1.1" 200 2387
2025-09-08 11:23:52,046 - INFO - [CACHE HIT] Loaded 51 videos for 'electronic' from MinIO.
2025-09-08 11:23:52,047 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=electronic&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:23:52,559 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_electronic.parquet HTTP/1.1" 200 0
2025-09-08 11:23:52,559 - INFO - [API CALL] Saved 50 new videos for 'electronic' (total 51) to MinIO.
2025-09-08 11:23:52,561 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_heavy%20metal.parquet HTTP/1.1" 200 2384
2025-09-08 11:23:52,562 - INFO - [CACHE HIT] Loaded 50 videos for 'heavy metal' from MinIO.
2025-09-08 11:23:52,563 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=heavy+metal&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:23:52,981 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_heavy%20metal.parquet HTTP/1.1" 200 0
2025-09-08 11:23:52,981 - INFO - [API CALL] Saved 50 new videos for 'heavy metal' (total 51) to MinIO.
2025-09-08 11:23:52,984 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_country.parquet HTTP/1.1" 200 2380
2025-09-08 11:23:52,988 - INFO - [CACHE HIT] Loaded 51 videos for 'country' from MinIO.
2025-09-08 11:23:52,988 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=country&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:23:53,457 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_country.parquet HTTP/1.1" 200 0
2025-09-08 11:23:53,458 - INFO - [API CALL] Saved 50 new videos for 'country' (total 51) to MinIO.
2025-09-08 11:23:53,464 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_jazz.parquet HTTP/1.1" 200 2415
2025-09-08 11:23:53,469 - INFO - [CACHE HIT] Loaded 55 videos for 'jazz' from MinIO.
2025-09-08 11:23:53,469 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=jazz&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:23:53,904 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_jazz.parquet HTTP/1.1" 200 0
2025-09-08 11:23:53,904 - INFO - [API CALL] Saved 50 new videos for 'jazz' (total 55) to MinIO.
2025-09-08 11:23:53,907 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_hip%20hop.parquet HTTP/1.1" 200 2412
2025-09-08 11:23:53,912 - INFO - [CACHE HIT] Loaded 54 videos for 'hip hop' from MinIO.
2025-09-08 11:23:53,913 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=hip+hop&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:23:54,366 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_hip%20hop.parquet HTTP/1.1" 200 0
2025-09-08 11:23:54,367 - INFO - [API CALL] Saved 50 new videos for 'hip hop' (total 54) to MinIO.
2025-09-08 11:23:54,371 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_classical.parquet HTTP/1.1" 200 2513
2025-09-08 11:23:54,375 - INFO - [CACHE HIT] Loaded 60 videos for 'classical' from MinIO.
2025-09-08 11:23:54,376 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=classical&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:23:54,735 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_classical.parquet HTTP/1.1" 200 0
2025-09-08 11:23:54,735 - INFO - [API CALL] Saved 50 new videos for 'classical' (total 60) to MinIO.
2025-09-08 11:23:54,738 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_folk.parquet HTTP/1.1" 200 2345
2025-09-08 11:23:54,743 - INFO - [CACHE HIT] Loaded 50 videos for 'folk' from MinIO.
2025-09-08 11:23:54,744 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=folk&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:23:55,078 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_folk.parquet HTTP/1.1" 200 0
2025-09-08 11:23:55,079 - INFO - [API CALL] Saved 50 new videos for 'folk' (total 50) to MinIO.
2025-09-08 11:23:55,082 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_rock.parquet HTTP/1.1" 200 2348
2025-09-08 11:23:55,088 - INFO - [CACHE HIT] Loaded 50 videos for 'rock' from MinIO.
2025-09-08 11:23:55,089 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=rock&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:23:55,486 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_rock.parquet HTTP/1.1" 200 0
2025-09-08 11:23:55,486 - INFO - [API CALL] Saved 50 new videos for 'rock' (total 50) to MinIO.
2025-09-08 11:23:55,488 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_reggae.parquet HTTP/1.1" 200 3011
2025-09-08 11:23:55,491 - INFO - [CACHE HIT] Loaded 96 videos for 'reggae' from MinIO.
2025-09-08 11:23:55,492 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=reggae&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:23:55,890 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_reggae.parquet HTTP/1.1" 200 0
2025-09-08 11:23:55,891 - INFO - [API CALL] Saved 50 new videos for 'reggae' (total 96) to MinIO.
2025-09-08 11:23:55,893 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_blues.parquet HTTP/1.1" 200 2502
2025-09-08 11:23:55,899 - INFO - [CACHE HIT] Loaded 61 videos for 'blues' from MinIO.
2025-09-08 11:23:55,901 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=blues&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:23:56,373 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_blues.parquet HTTP/1.1" 200 0
2025-09-08 11:23:56,374 - INFO - [API CALL] Saved 50 new videos for 'blues' (total 105) to MinIO.
2025-09-08 11:23:56,379 - DEBUG - http://localhost:9000 "GET /bronze-layer/youtube_search_r%26b.parquet HTTP/1.1" 200 2345
2025-09-08 11:23:56,381 - INFO - [CACHE HIT] Loaded 50 videos for 'r&b' from MinIO.
2025-09-08 11:23:56,382 - DEBUG - URL being requested: GET https://youtube.googleapis.com/youtube/v3/search?part=snippet&q=r%26b&type=video&regionCode=US&maxResults=50&order=viewCount&key=AIzaSyBa9dluDh7aZfkmBFA5cowYFrKDVbDhL8o&alt=json
2025-09-08 11:23:56,782 - DEBUG - http://localhost:9000 "PUT /bronze-layer/youtube_search_r%26b.parquet HTTP/1.1" 200 0
2025-09-08 11:23:56,782 - INFO - [API CALL] Saved 50 new videos for 'r&b' (total 50) to MinIO.
2025-09-08 11:23:56,784 - ERROR - Error in youtube_search_op: merge_search_tables() takes 1 positional argument but 2 were given
[32m2025-09-08 11:23:56 -0500[0m - dagster - [34mERROR[0m - [31myoutube_job - 639754bf-9405-41e6-a15c-2554bcce35ea - 33489 - youtube_search_op - STEP_FAILURE - Execution of step "youtube_search_op" failed.

dagster._core.errors.DagsterExecutionStepExecutionError: Error occurred while executing op "youtube_search_op"::

TypeError: merge_search_tables() takes 1 positional argument but 2 were given

Stack Trace:
  File "/Users/alisoncordoba/captone/music_and_marketing_audit/.venv/lib/python3.13/site-packages/dagster/_core/execution/plan/utils.py", line 57, in op_execution_error_boundary
    yield
  File "/Users/alisoncordoba/captone/music_and_marketing_audit/.venv/lib/python3.13/site-packages/dagster/_utils/__init__.py", line 392, in iterate_with_context
    next_output = next(iterator)
  File "/Users/alisoncordoba/captone/music_and_marketing_audit/src/ingestion/youtubeapi.py", line 280, in youtube_search_op
    search_df = merge_search_tables(all_data_list, minio_client)
[0m
